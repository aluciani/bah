#include "json.bah"

struct json_test_struct {
    id: int
    type: cpstring
}


testJson() bool {
    // const JSON_DATA = "
    // [
    //     {
    //         \"id\": 2489651045,
    //         \"type\": \"user\"
    //     },
    //     {
    //         \"id\": 2489651046,
    //         \"type\": \"post\"
    //     }
    // ]
    // "
    // json = parseJson(JSON_DATA)
    // fe = json.children[0]
    // id = fe.map("id")
    // if id.content != "2489651045" {
    //     return false
    // }


    t1 = new json_test_struct
    t1.id = 543
    t1.type = "user"

    t2 = json_test_struct{
        id: 543
        type: "user"
    }

    t1s = toJson(t1)
    t2s = toJson(&t2)

    t3 = new json_test_struct
    t4 = json_test_struct{}

    j = parseJson(t1s)
    j.scan(t3)

    j = parseJson(t2s)
    j.scan(&t4)

    if t3.id != t4.id || t3.type != t4.type {
        return false
    }


    return true
}